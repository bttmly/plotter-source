// Generated by CoffeeScript 1.7.1
(function() {
  (function(App) {
    return $(function() {
      var $$, appControls, gameSeasonSwitch, highlightButton, playerPositionSwitch, players, positions, renderButton, seasons, variables;
      $$ = Controls;
      appControls = [playerPositionSwitch = $$("#input-group--pp-switch"), gameSeasonSwitch = $$("#input-group--gs-switch"), positions = $$("#input-group--positions"), players = $$("#input-group--players"), variables = $$("#input-group--variables"), seasons = $$("#input-group--seasons"), renderButton = $$("#control-button--render"), highlightButton = $$("#control-button--highlight")];
      Plotter.controls = $$(appControls);
      Plotter.controls.formattedValues = function() {
        var ppVal, ret, seasonVal, v, valid, varVal, _i, _len, _ref, _ref1, _ref2, _ref3;
        ret = {};
        valid = true;
        if ((ppVal = (_ref = playerPositionSwitch.value()) != null ? (_ref1 = _ref[0]) != null ? _ref1.val : void 0 : void 0)) {
          if (ppVal === "positions") {
            ret.ppVal = positions.value().map(function(obj) {
              return obj.val;
            });
          } else if (ppVal === "players") {
            ret.ppVal = _.flatten(players.value().map(function(obj) {
              return obj.val;
            }));
          }
        } else {
          valid = false;
        }
        if ((seasonVal = seasons.value())) {
          ret.seasons = seasonVal.map(function(obj) {
            return obj.val;
          });
        } else {
          valid = false;
        }
        if ((varVal = variables.value())) {
          ret.vars = {};
          for (_i = 0, _len = varVal.length; _i < _len; _i++) {
            v = varVal[_i];
            ret.vars[v.id] = v.val[0];
          }
        } else {
          valid = false;
        }
        if (!(ret.gsVal = (_ref2 = gameSeasonSwitch.value()) != null ? (_ref3 = _ref2[0]) != null ? _ref3.val : void 0 : void 0)) {
          valid = false;
        }
        if (!valid) {
          return valid;
        } else {
          return ret;
        }
      };
      renderButton.on("click", function(event) {
        return App.trigger("requestRender", Plotter.controls.formattedValues());
      });
      renderButton.disabled(true);
      highlightButton.disabled(true);
      $("#input-group--players").hide();
      $("#input-group--positions").hide();
      playerPositionSwitch.on("change", function(event) {
        var value;
        value = this.value()[0].val;
        if (value === "players") {
          $("#input-group--players").slideDown();
          return $("#input-group--positions").slideUp();
        } else {
          $("#input-group--positions").slideDown();
          return $("#input-group--players").slideUp();
        }
      });
      return Plotter.controls.on("change", function(event) {
        if (Plotter.controls.formattedValues()) {
          return renderButton.disabled(false);
        }
      });
    });
  })(window.Plotter);

}).call(this);
